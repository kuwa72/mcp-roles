# MCP Role Server

Model Context Protocol (MCP)規格に準拠したロール提供サーバーです。このツールを利用することで、Claude Desktopなどの大規模言語モデル(LLM)に特定の役割や振る舞いを簡単に指示できます。

#＃ 参考資料
- TypeScript SDK: https://github.com/modelcontextprotocol/typescript-sdk
- Description of the MCP: https://modelcontextprotocol.io/sdk/java/mcp-overview

## 背景

LLMとの対話において、特定のタスクに適した振る舞いをさせるには通常、毎回詳細な指示を入力する必要があります。例えば：
- ソフトウェア開発時にはエンジニアとして振る舞ってほしい
- アイデア発想時にはリサーチャーとして振る舞ってほしい
- デザイン検討時にはアーティストとして振る舞ってほしい

このサーバーは、事前に定義したロール（役割）を選択するだけで、適切な指示文をLLMに提供することで、この問題を解決します。

## 動作原理

このサーバーはModel Context Protocol (MCP)に準拠しており、Claude DesktopなどのMCP対応アプリケーションと連携します。MCPは、LLMアプリケーションと外部データソース・ツール間のシームレスな統合を可能にするプロトコルです。

1. サーバーは標準入出力(Stdio)でMCPプロトコルによる通信を行います
2. 対話開始時にユーザーにロール選択肢を提示します
3. 選択されたロールに対応するMarkdownファイルの内容をLLMに送信します

## 機能

- **ロール一覧の取得** - 利用可能な全ロールとその簡単な説明を取得
- **特定ロールの詳細取得** - 選択したロールの完全な指示内容を取得
- **Markdownベースのロール定義** - 構造化された読みやすいフォーマットでロールを定義

## インストールと要件

### 要件
- [Deno](https://deno.land/) 1.36.0以上
- MCPプロトコルに対応したLLMアプリケーション（Claude Desktopなど）

### インストール
```bash
# リポジトリをクローン
git clone https://github.com/kuwa72/mcp-roles.git
cd mcp-roles

# 必要なディレクトリ構造は既に含まれています
```

## 使用方法

### サーバー起動
```bash
# 開発モードで起動
deno task start
```

### コマンド
サーバーは以下のMCPコマンドをサポートしています：

- `list-roles`
  - 説明: 利用可能なロール一覧を取得
  - パラメータ: 不要
  - 戻り値: `{ roles: [{ id, name, description }, ...] }`

- `get-role`
  - 説明: 特定のロール詳細を取得
  - パラメータ: `roleId` (文字列)
  - 戻り値: `{ id, name, context }`

## カスタムロールの追加

ロールは以下のいずれかのディレクトリにMarkdown形式で保存されます：

1. デフォルトのロールディレクトリ: `./roles/`
2. ユーザー設定のロールディレクトリ: `~/.config/mcp-roles/roles/`

サーバーは起動時に、ユーザー設定のロールディレクトリが存在する場合はそれを使用し、存在しない場合はデフォルトのディレクトリを使用します。

新しいロールを追加するには、以下の形式で新規ファイルを作成します：

1. `[ロールディレクトリ]/[ロールID].md` というファイル名で作成
2. 以下の形式でコンテンツを記述：

```markdown
# ロール名

簡単な説明（一段落）

## セクションタイトル
- 箇条書き
- 項目

## 別のセクション
詳細な指示や情報
```

ファイル構造のポイント：
- 最初の見出し(`# `)がロール名として使用されます
- 最初の段落が説明として使用されます
- 残りの内容がコンテキストとしてそのままLLMに送信されます

## アーキテクチャ

このプロジェクトは以下のコンポーネントで構成されています：

- `main.ts` - MCPサーバーのエントリポイント
- `role_manager.ts` - ロールの検索と読み込みを行うモジュール
- `deps.ts` - 依存関係の管理
- `roles/` - Markdownフォーマットのロール定義ファイル

## ライセンス

MIT

## 貢献

問題の報告やプルリクエストは歓迎します。新しいロールの提案も受け付けています。
